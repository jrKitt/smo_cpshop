;/*FB_PKG_DELIM*/

__d("LSOptimisticEditMessageStoredProcedure",["LSOptimisticEditMessage","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticEditMessage"),e.messageId,e.text);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("withMWXPopover",["BaseMenuContext","BaseMultiPageViewContext","BasePopoverTrigger.react","MWXPopover.react","MWXPopoverLoadingState.react","lazyLoadComponent","react","react-compiler-runtime","tracePolicyFromResource","useCometPopoverInteractionTracing","withCometPlaceholder"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext;b.useMemo;function a(a,b){function e(e){var f=d("react-compiler-runtime").c(42),g,h,k,l,m,n,o;f[0]!==e?(g=e.onHoverIn,h=e.onHoverOut,k=e.popover,l=e.popoverPresentationProps,m=e.popoverProps,n=e.preloadTrigger,o=babelHelpers.objectWithoutPropertiesLoose(e,["onHoverIn","onHoverOut","popover","popoverPresentationProps","popoverProps","preloadTrigger"]),f[0]=e,f[1]=g,f[2]=h,f[3]=k,f[4]=l,f[5]=m,f[6]=n,f[7]=o):(g=f[1],h=f[2],k=f[3],l=f[4],m=f[5],n=f[6],o=f[7]);e=(e=j(c("BaseMenuContext")))!=null?e:{};var p=e.onClose;e=(e=j(c("BaseMultiPageViewContext")))!=null?e:{};var q=e.pushPage;if(f[8]!==k){f[10]===Symbol["for"]("react.memo_cache_sentinel")?(e=i.jsx(c("MWXPopoverLoadingState.react"),{withArrow:!1}),f[10]=e):e=f[10];e=d("withCometPlaceholder").withCometPlaceholder(c("lazyLoadComponent")(k),e,b);f[8]=k;f[9]=e}else e=f[9];e=e;var r=e;f[11]!==k?(e=c("tracePolicyFromResource")("comet.popover",k),f[11]=k,f[12]=e):e=f[12];e=c("useCometPopoverInteractionTracing")(e,"lazy");if(f[13]!==l){var s;s=(s=l)!=null?s:{};f[13]=l;f[14]=s}else s=f[14];var t,u;if(f[15]!==s){l=s;t=l.align;u=l.position;l=babelHelpers.objectWithoutPropertiesLoose(l,["align","position"]);f[15]=s;f[16]=l;f[17]=t;f[18]=u}else l=f[16],t=f[17],u=f[18];s=t===void 0?"middle":t;t=u===void 0?"above":u;f[19]!==r?(u=function(a){return i.jsx(c("MWXPopover.react"),{withArrow:!0,children:i.jsx(r,babelHelpers["extends"]({},a))})},f[19]=r,f[20]=u):u=f[20];u=u;u=u;var v;f[21]!==r||f[22]!==p?(v=function(a){return function(b){b=b.onReturn;return i.jsx(r,babelHelpers["extends"]({},a,{onClose:p!=null?p:b}))}},f[21]=r,f[22]=p,f[23]=v):v=f[23];v=v;var w=v;f[24]!==w||f[25]!==p||f[26]!==g||f[27]!==h||f[28]!==m||f[29]!==q||f[30]!==o?(v=function(b,c,d,e,f){return i.jsx(a,babelHelpers["extends"]({onHoverIn:function(a){e(a),g==null?void 0:g(a)},onHoverOut:function(a){f(),h==null?void 0:h(a)}},o,{onPress:function(){var b;for(var d=arguments.length,a=new Array(d),e=0;e<d;e++)a[e]=arguments[e];var f=a;q!=null&&p!=null?q(w(m)):c();o.onPress==null?void 0:(b=o).onPress.apply(b,f)},preventClosingMenuOnSelect:!0,ref:b}))},f[24]=w,f[25]=p,f[26]=g,f[27]=h,f[28]=m,f[29]=q,f[30]=o,f[31]=v):v=f[31];var x;f[32]!==u||f[33]!==s||f[34]!==l||f[35]!==k||f[36]!==m||f[37]!==t||f[38]!==n||f[39]!==v||f[40]!==e?(x=i.jsx(c("BasePopoverTrigger.react"),babelHelpers["extends"]({align:s,position:t},l,{interactionTracker:e,popover:u,popoverPreloadResource:k,popoverProps:m,preloadTrigger:n,children:v})),f[32]=u,f[33]=s,f[34]=l,f[35]=k,f[36]=m,f[37]=t,f[38]=n,f[39]=v,f[40]=e,f[41]=x):x=f[41];return x}return e}g["default"]=a}),98);
__d("MWXComposerButtonGroupPopoverButton.react",["MWXComposerButtonGroupButton.react","react","withMWXPopover"],(function(a,b,c,d,e,f,g){"use strict";var h;h||d("react");a=c("withMWXPopover")(c("MWXComposerButtonGroupButton.react"));b=a;g["default"]=b}),98);
__d("MWXIconFaceHappy",["MWXSvgIcon","SVGIcon","cr:12413","gkx"],(function(a,b,c,d,e,f,g){"use strict";a=d("MWXSvgIcon").mwxSvgIcon(d("SVGIcon").svgIcon(b("cr:12413")),c("gkx")("23219"));g["default"]=a}),98);
__d("MWXComposerEmojiButton.react",["fbt","JSResourceForInteraction","LexicalComposerContext","MWXComposerButtonGroupPopoverButton.react","MWXIconFaceHappy","MessengerWebUXLogger","Promise","promiseDone","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||d("react"),l=c("JSResourceForInteraction")("cometAddEmojiToComposerForLexical").__setRef("MWXComposerEmojiButton.react");function a(){var a=d("react-compiler-runtime").c(9),e=d("LexicalComposerContext").useLexicalComposerContext(),f=e[0],g=c("MessengerWebUXLogger").useInteractionLogger();a[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=h._(/*BTDS*/"\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e2d\u0e35\u0e42\u0e21\u0e08\u0e34"),a[0]=e):e=a[0];var j;a[1]!==g?(j=function(){l.preload(),g==null?void 0:g({eventName:"composer_open_emoji_picker"})},a[1]=g,a[2]=j):j=a[2];var m;a[3]===Symbol["for"]("react.memo_cache_sentinel")?(m=c("JSResourceForInteraction")("MWV2ComposerEmojiPickerForJSResource").__setRef("MWXComposerEmojiButton.react"),a[3]=m):m=a[3];var n;a[4]!==f?(n={onSelect:function(a){return c("promiseDone")(l.load(),function(c){c(a,f,16);return(i||(i=b("Promise"))).resolve()})},withArrow:!1},a[4]=f,a[5]=n):n=a[5];a[6]!==j||a[7]!==n?(e=k.jsx(c("MWXComposerButtonGroupPopoverButton.react"),{icon:c("MWXIconFaceHappy"),label:e,onPress:j,popover:m,popoverProps:n,preloadTrigger:"button",testid:void 0}),a[6]=j,a[7]=n,a[8]=e):e=a[8];return e}g["default"]=a}),226);
__d("useMAWGetSendEditActionForSecure",["FBLogger","LSMessagingThreadAttributionType","MAWBridgeSendAndReceive","MAWDbMsg","MAWExternalId","MAWGetProtocolMsgIdByMsgIdInUI","MAWLoggerUtils","MAWMessageSendReporter","MAWMessageSendReporterV2","MAWMiActOnActThreadReady","QPLUserFlow","ReQL","ReQLSuspense","promiseDone","qpl","react","react-compiler-runtime","sendToSentQPLLogger","useLSMessagingSource","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;(i||d("react")).useCallback;function a(a){var b=d("react-compiler-runtime").c(10),e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=d("MAWLoggerUtils").getInstanceKey(),b[0]=e):e=b[0];var g=e,i=(h||(h=c("useReStore")))(),k;b[1]!==i||b[2]!==a?(e=function(){return a!=null?d("ReQL").fromTableAscending(i.tables.threads).getKeyRange(a):d("ReQL").empty()},k=[i,a],b[1]=i,b[2]=a,b[3]=e,b[4]=k):(e=b[3],k=b[4]);var l=d("ReQLSuspense").useFirst(e,k,f.id+":45"),m=c("useLSMessagingSource")();b[5]!==i||b[6]!==m||b[7]!==l||b[8]!==a?(e=function(b,e){if(a==null||b==null)return;var f=d("MAWDbMsg").toMsgId(b);if(f==null)return;c("QPLUserFlow").start(c("qpl")._(1056849558,"2236"),{instanceKey:g});c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(i.tables,a,"MWV2ComposerEditContainer.react",function(a,b){return d("MAWGetProtocolMsgIdByMsgIdInUI").getProtocolMsgIdByMsgIdUI(f).then(function(a){if(a!=null){var b=d("MAWExternalId").generateExternalId(),f=a.chat,g=function(g){return d("MAWBridgeSendAndReceive").sendAndReceive("backend","sendEditMsg",{args:{editMsgContent:{content:e,mentionedJids:[]},originalProtocolMsgId:a},chatJid:f,externalId:b,qplEventType:c("qpl")._(25313175,"1551"),qplInstanceKey:g})};if(d("MAWMessageSendReporterV2").isMessageSendReporterV2Enabled())return d("MAWMessageSendReporterV2").MAWMessageSendReporterV2({composerEntrypoint:"useMAWGetSendEditActionForSecure",externalId:b,lsSource:m,messageTypeParamsArgs:{isEdit:!0},thread:l},function(a){return g(a).then(j)},i);else{var h=d("sendToSentQPLLogger").markSendToSentStartWithAnnotation(l,{isEdit:!0},c("LSMessagingThreadAttributionType").UNKNOWN,void 0,void 0,b);return d("MAWMessageSendReporter").MAWMessageSendReporter({chatJid:f,externalId:b},g(h),{qplEventType:c("qpl")._(25313175,"1551"),qplInstanceKey:h},i)}}}).then(function(a){c("QPLUserFlow").endSuccess(c("qpl")._(1056849558,"2236"),{instanceKey:g})})["catch"](function(a){c("FBLogger")("messenger_web").catching(a).mustfix("Failed to edit message: %s.",a),c("QPLUserFlow").endFailure(c("qpl")._(1056849558,"2236"),"failure",{instanceKey:g})})}))},b[5]=i,b[6]=m,b[7]=l,b[8]=a,b[9]=e):e=b[9];return e}function j(a){return[a]}g["default"]=a}),98);
__d("useMAWGetSendEditActionforOpen",["LSFactory","LSOptimisticEditMessageStoredProcedure","promiseDone","react","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;(i||d("react")).useCallback;function a(){var a=d("react-compiler-runtime").c(2),b=(h||(h=c("useReStore")))(),e;a[0]!==b?(e=function(a,d){return c("promiseDone")(b.runInTransaction(function(b){return c("LSOptimisticEditMessageStoredProcedure")(c("LSFactory")(b),{messageId:a,text:d})},"readwrite",void 0,void 0,f.id+":27"))},a[0]=b,a[1]=e):e=a[1];return e}g["default"]=a}),98);
__d("useMWComposerEmojiTransform",["react","react-compiler-runtime","requireDeferred","useDeferredModuleOnReady"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect,j=c("requireDeferred")("getUpgradedCometEmojiComposerHandler").__setRef("useMWComposerEmojiTransform");function a(a){var b=d("react-compiler-runtime").c(4),e=c("useDeferredModuleOnReady")(j),f,g;b[0]!==e||b[1]!==a?(f=function(){return e==null?void 0:e(a,16)},g=[a,e],b[0]=e,b[1]=a,b[2]=f,b[3]=g):(f=b[2],g=b[3]);i(f,g)}g["default"]=a}),98);
__d("useMWXComposerClearAndSendOnEnter",["Lexical","MLCKeyBindingUtil","gkx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useInsertionEffect,j=b.useLayoutEffect,k=b.useRef,l=250;function a(a,b){var e=d("react-compiler-runtime").c(13),f=a.clearReplyState,g=a.editor,h=a.onSend,m=k(null),n=k(b),o;e[0]!==b?(a=function(){n.current=b},o=[b],e[0]=b,e[1]=a,e[2]=o):(a=e[1],o=e[2]);i(a,o);e[3]!==f||e[4]!==g||e[5]!==h?(a=function(){var a=h(n.current);f==null?void 0:f();(a||!1)&&g.dispatchCommand(d("Lexical").CLEAR_EDITOR_COMMAND)},e[3]=f,e[4]=g,e[5]=h,e[6]=a):a=e[6];var p=a;e[7]!==g||e[8]!==p?(o=function(){return g.registerCommand(d("Lexical").KEY_ENTER_COMMAND,function(a){if(a!=null&&!a.shiftKey&&!a.altKey&&(!c("gkx")("23402")||d("MLCKeyBindingUtil").hasCommandModifier(a))){a.preventDefault();var b=m.current;if(b!=null&&a.timeStamp-b<=l&&c("gkx")("15485")){m.current=a.timeStamp;return!0}p();m.current=a.timeStamp;return!0}return!1},d("Lexical").COMMAND_PRIORITY_LOW)},a=[g,p],e[7]=g,e[8]=p,e[9]=o,e[10]=a):(o=e[9],a=e[10]);j(o,a);e[11]!==p?(o={onSend:p},e[11]=p,e[12]=o):o=e[12];return o}g["default"]=a}),98);
__d("useMWXLexicalEditor",["CometLexicalEmojiNode","Lexical","MessengerLexicalActorNode","cometLexicalBaseTheme","cr:11494","react-compiler-runtime","useLexicalInitializeEditor__DEPRECATED","useMWPLexicalClearEditor","useStable"],(function(a,b,c,d,e,f,g){"use strict";var h=[d("MessengerLexicalActorNode").MessengerLexicalActorNode,b("cr:11494")==null?void 0:b("cr:11494").MessengerLexicalCommandNode,d("CometLexicalEmojiNode").EmojiNode];function a(){var a=d("react-compiler-runtime").c(2),b=c("useStable")(i);c("useMWPLexicalClearEditor")(b);c("useLexicalInitializeEditor__DEPRECATED")(b);var e;a[0]!==b?(e={editor:b},a[0]=b,a[1]=e):e=a[1];return e}function i(){return d("Lexical").createEditor({namespace:"MWPEditor",nodes:h.filter(Boolean),onError:j,theme:babelHelpers["extends"]({},c("cometLexicalBaseTheme"),{paragraph:"xat24cr xdj266r"})})}function j(){}g.useMWXLexicalEditor=a}),98);
__d("MWV2ComposerEditContainer.react",["fbt","LSMessagingThreadTypeUtil","Lexical","LexicalText","MAWEditMessageContext.react","MAWVault","MWLSThreadDisplayContext","MWPActor.react","MWXComposer.react","MWXComposerEmojiButton.react","MWXIconCheckmarkCircle","MWXIconCross","ReQL","ReQLSuspense","cr:21357","isStringNullOrEmpty","react","react-compiler-runtime","useLogMAWEditMessage","useMAWGetSendEditActionForSecure","useMAWGetSendEditActionforOpen","useMWComposerEmojiTransform","useMWXComposerClearAndSendOnEnter","useMWXLexicalEditor","usePrepopulateLexicalEditor","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=j||(j=d("react"));e=j;var l=e.useContext,m=e.useEffect;e.useMemo;var n=e.useState;function a(a){var e=d("react-compiler-runtime").c(66),g=a.confirmationText,j=a.contentEditableProps,p=a.editMessageData,q=a.headerText,r=a.isEmojiMentionsEnabled,s=a.onEditCancelCallback;a=a.onEditTriggerCallback;g=g===void 0?null:g;q=q===void 0?null:q;r=r===void 0?!0:r;var t=s===void 0?null:s,u=a===void 0?null:a,v=(i||(i=c("useReStore")))();s=l(d("MAWEditMessageContext.react").Context);var w=s.setEditMessageData,x=d("MWPActor.react").useActor();e[0]!==v.tables.messages||e[1]!==(p==null?void 0:p.messageId)||e[2]!==(p==null?void 0:p.threadKey)||e[3]!==(p==null?void 0:p.timestampMs)?(a=function(){return d("ReQL").fromTableAscending(v.tables.messages).getKeyRange(p==null?void 0:p.threadKey,p==null?void 0:p.timestampMs,p==null?void 0:p.messageId)},e[0]=v.tables.messages,e[1]=p==null?void 0:p.messageId,e[2]=p==null?void 0:p.threadKey,e[3]=p==null?void 0:p.timestampMs,e[4]=a):a=e[4];s=p==null?void 0:p.messageId;var y=p==null?void 0:p.threadKey,z=p==null?void 0:p.timestampMs,A;e[5]!==v||e[6]!==s||e[7]!==y||e[8]!==z?(A=[v,s,y,z],e[5]=v,e[6]=s,e[7]=y,e[8]=z,e[9]=A):A=e[9];var B=d("ReQLSuspense").useFirst(a,A,f.id+":60"),C=c("useMAWGetSendEditActionforOpen")(),D=c("useMAWGetSendEditActionForSecure")(B==null?void 0:B.threadKey);B==null?void 0:B.text;y=(s=B==null?void 0:B.text)!=null?s:"";e[10]!==y?(z=d("MAWVault").unvault(y).trim(),e[10]=y,e[11]=z):z=e[11];a=z;var E=a,F=c("useLogMAWEditMessage")();A=d("useMWXLexicalEditor").useMWXLexicalEditor();var G=A.editor;e[12]!==x||e[13]!==p||e[14]!==G||e[15]!==F||e[16]!==(B==null?void 0:B.messageId)||e[17]!==u||e[18]!==C||e[19]!==D||e[20]!==E||e[21]!==w?(s=function(){var a=G.getEditorState().read(d("LexicalText").$rootTextContent).trim();if(c("isStringNullOrEmpty")(a)||a===E)return!1;d("LSMessagingThreadTypeUtil").isArmadilloSecure(p.threadType)?D(B==null?void 0:B.messageId,a):C(p.messageId,a);F(p.threadType,p.threadKey,p.messageId,x,"EDIT_MESSAGE");w(null);u&&u();return!0},e[12]=x,e[13]=p,e[14]=G,e[15]=F,e[16]=B==null?void 0:B.messageId,e[17]=u,e[18]=C,e[19]=D,e[20]=E,e[21]=w,e[22]=s):s=e[22];var H=s;o(G,w,t);e[23]!==G||e[24]!==H?(y={clearReplyState:null,editor:G,onSend:H},e[23]=G,e[24]=H,e[25]=y):y=e[25];c("useMWXComposerClearAndSendOnEnter")(y);z=n(!1);a=z[0];var I=z[1];e[26]!==G||e[27]!==E?(A=function(){return G.registerTextContentListener(function(a){a=a.trim();I(!c("isStringNullOrEmpty")(a)&&a!==E)})},s=[G,E],e[26]=G,e[27]=E,e[28]=A,e[29]=s):(A=e[28],s=e[29]);m(A,s);c("usePrepopulateLexicalEditor")(G,E,!0);c("useMWComposerEmojiTransform")(G);y=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext();z=y==="Inbox"?32:24;e[30]!==q?(A=q!=null?q:h._(/*BTDS*/"\u0e41\u0e01\u0e49\u0e44\u0e02\u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21"),e[30]=q,e[31]=A):A=e[31];e[32]===Symbol["for"]("react.memo_cache_sentinel")?(s=h._(/*BTDS*/"\u0e22\u0e01\u0e40\u0e25\u0e34\u0e01\u0e01\u0e32\u0e23\u0e41\u0e01\u0e49\u0e44\u0e02"),e[32]=s):s=e[32];e[33]!==t||e[34]!==w?(y=function(){w(null),t&&t()},e[33]=t,e[34]=w,e[35]=y):y=e[35];e[36]!==z||e[37]!==y?(q=k.jsx(d("MWXComposer.react").Button,{color:"primary",icon:c("MWXIconCross"),label:s,onPress:y,size:z}),e[36]=z,e[37]=y,e[38]=q):q=e[38];e[39]!==A||e[40]!==q?(s=k.jsx(d("MWXComposer.react").Header,{hasTopBorder:!0,headlineText:A,rightAddon:q},0),e[39]=A,e[40]=q,e[41]=s):s=e[41];e[42]!==j?(z=k.jsx(d("MWXComposer.react").TextEditor,{contentEditableProps:j,testid:void 0}),e[42]=j,e[43]=z):z=e[43];e[44]===Symbol["for"]("react.memo_cache_sentinel")?(y=k.jsx(c("MWXComposerEmojiButton.react"),{}),e[44]=y):y=e[44];e[45]!==z?(A=k.jsxs(d("MWXComposer.react").InputArea,{children:[z,y]}),e[45]=z,e[46]=A):A=e[46];q=!a;e[47]!==g?(j=g!=null?g:h._(/*BTDS*/"\u0e41\u0e01\u0e49\u0e44\u0e02"),e[47]=g,e[48]=j):j=e[48];e[49]!==H?(y=function(){H()},e[49]=H,e[50]=y):y=e[50];e[51]!==q||e[52]!==j||e[53]!==y?(z=k.jsx(d("MWXComposer.react").Button,{disabled:q,icon:c("MWXIconCheckmarkCircle"),label:j,onPress:y,testid:void 0}),e[51]=q,e[52]=j,e[53]=y,e[54]=z):z=e[54];e[55]!==G||e[56]!==r?(a=r&&b("cr:21357")&&k.jsx(b("cr:21357"),{editor:G}),e[55]=G,e[56]=r,e[57]=a):a=e[57];e[58]!==A||e[59]!==z||e[60]!==a?(g=k.jsxs(d("MWXComposer.react").Row,{children:[A,z,a]}),e[58]=A,e[59]=z,e[60]=a,e[61]=g):g=e[61];e[62]!==G||e[63]!==s||e[64]!==g?(q=k.jsx(d("MWXComposer.react").Composer,{editor:G,header:s,children:g}),e[62]=G,e[63]=s,e[64]=g,e[65]=q):q=e[65];return q}function o(a,b,c){var e=d("react-compiler-runtime").c(5),f=c===void 0?null:c,g;e[0]!==a||e[1]!==f||e[2]!==b?(c=function(){return a.registerCommand(d("Lexical").KEY_ESCAPE_COMMAND,function(a){a.preventDefault();a.stopImmediatePropagation();a.stopPropagation();b(null);f&&f();return!0},d("Lexical").COMMAND_PRIORITY_CRITICAL)},g=[a,b,f],e[0]=a,e[1]=f,e[2]=b,e[3]=c,e[4]=g):(c=e[3],g=e[4]);m(c,g)}g["default"]=a}),226);